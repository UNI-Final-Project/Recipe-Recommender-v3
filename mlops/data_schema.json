{
  "name": "Recipe Recommender Data Schema",
  "version": "1.0.0",
  "description": "Schema validation for recipe recommendation system",
  "created_at": "2024-12-30",
  
  "input_schema": {
    "query": {
      "type": "string",
      "description": "User search query",
      "min_length": 1,
      "max_length": 500,
      "required": true
    }
  },
  
  "output_schema": {
    "recetas": {
      "type": "array",
      "description": "Array of recommended recipes",
      "min_items": 1,
      "max_items": 20,
      "items": {
        "type": "object",
        "properties": {
          "nombre": {
            "type": "string",
            "description": "Recipe name",
            "min_length": 1,
            "max_length": 200
          },
          "descripci贸n": {
            "type": "string",
            "description": "Recipe description",
            "max_length": 1000
          },
          "ingredientes": {
            "type": "array",
            "description": "List of ingredients",
            "items": {"type": "string"}
          },
          "instrucciones": {
            "type": "array",
            "description": "Step by step instructions",
            "items": {"type": "string"}
          },
          "calificaci贸n_promedio": {
            "type": "number",
            "description": "Average rating",
            "minimum": 0,
            "maximum": 5
          }
        },
        "required": ["nombre", "descripci贸n", "ingredientes", "instrucciones", "calificaci贸n_promedio"]
      }
    }
  },
  
  "training_data_schema": {
    "query": {
      "type": "string",
      "description": "Search query",
      "required": true
    },
    "recipe_id": {
      "type": "integer",
      "description": "Recipe identifier",
      "required": true
    },
    "rating": {
      "type": "number",
      "description": "User rating (0-5)",
      "minimum": 0,
      "maximum": 5,
      "required": true
    },
    "relevance": {
      "type": "integer",
      "description": "Relevance score (0=not relevant, 1=relevant)",
      "minimum": 0,
      "maximum": 1
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp",
      "required": false
    }
  },
  
  "model_config": {
    "embedding_model": {
      "type": "string",
      "value": "text-embedding-3-small",
      "description": "OpenAI embedding model"
    },
    "llm_model": {
      "type": "string",
      "value": "gpt-4.1-2025-04-14",
      "description": "LLM for translation"
    },
    "ranking_algorithm": {
      "type": "string",
      "value": "hybrid",
      "description": "Algorithm for ranking results"
    },
    "alpha": {
      "type": "number",
      "value": 0.7,
      "description": "Weight for semantic score (0-1)",
      "minimum": 0,
      "maximum": 1
    },
    "top_k": {
      "type": "integer",
      "value": 3,
      "description": "Number of recipes to return",
      "minimum": 1,
      "maximum": 20
    }
  },
  
  "metrics": {
    "ranking_metrics": [
      "mse",
      "mae",
      "rmse",
      "r2_score",
      "ndcg",
      "mrr"
    ],
    "classification_metrics": [
      "accuracy",
      "precision",
      "recall",
      "f1_score"
    ],
    "system_metrics": [
      "api_latency_ms",
      "translation_latency_ms",
      "embedding_latency_ms",
      "error_rate",
      "request_count"
    ]
  },
  
  "data_quality_rules": {
    "null_tolerance": {
      "recipe_id": 0.0,
      "rating": 0.05,
      "query": 0.0,
      "description": "Maximum percentage of null values allowed per column"
    },
    "value_ranges": {
      "rating": {"min": 0, "max": 5},
      "relevance": {"min": 0, "max": 1}
    },
    "duplicate_tolerance": 0.05,
    "description": "Maximum percentage of duplicate rows allowed"
  },
  
  "retraining_config": {
    "min_samples": 100,
    "description": "Minimum number of new samples before retraining",
    "test_split": 0.2,
    "description": "Test set size",
    "cv_folds": 5,
    "description": "Cross-validation folds",
    "performance_threshold": 0.05,
    "description": "Acceptable performance degradation (5%)"
  },
  
  "monitoring": {
    "latency_thresholds": {
      "warning": 2000,
      "critical": 5000,
      "unit": "milliseconds"
    },
    "error_rate_thresholds": {
      "warning": 0.02,
      "critical": 0.05,
      "unit": "percentage"
    },
    "anomaly_detection": {
      "enabled": true,
      "z_score_threshold": 3.0,
      "window_size": 10,
      "description": "Standard deviations from mean for anomaly detection"
    }
  }
}
